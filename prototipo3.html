<!doctype html>

<html>
<head>
   <meta charset="UTF-8" />
   <title>Protótipo 3</title>
   <style>
      body{
         background-color: black;
         color: white;
      }
   
      canvas {
         background-color: darkblue;
      }
      
   </style>
</head>
<body>
   <h1>CESJF-GG: Protótipo 3</h1>
   <canvas id="tela" width="640" height="480">Seu navegador não suporta o canvas! <a href="http://chrome.google.com">Atualize o seu navegador</a>!</canvas>

   <script>
      var tela=document.getElementById("tela");
      var tempo_atual= new Date(); 
      var tempo_anterior = new Date(); 
      var dt;
      var ctx = tela.getContext("2d");

      var jogador = {
         x: 100,
         y: 100,
         angulo: 0,
         vang: 0,      
         aceleracao: 0,
         vx: 0,
         vy: 0
      };
      
      function Asteroide(){
         this.x = 200;          
         this.y = 0;
         this.ax = 0;
         this.ay = 0;
         this.vx = 0;
         this.vy = 40;
      };
     
      var asteroide = new Asteroide();
      var d;
      var colisao = 0;    
      

      function desenho(){
         tempo_atual = new Date();
         dt = (tempo_atual - tempo_anterior) / 1000; 
         ctx.fillStyle = "darkblue";
         ctx.fillRect(0, 0, 640, 480);     
         ctx.fillStyle = "gray";
         
         ctx.strokeStyle = "white";
         
         //desenha triangulo
         ctx.save();
         ctx.translate(jogador.x, jogador.y);
         ctx.rotate(jogador.angulo * 2 * Math.PI / 360);         
         ctx.beginPath( );
         ctx.moveTo(0, -10);
         ctx.lineTo(8, 10);
         ctx.lineTo(-8, 10);
         ctx.lineTo(0, -10);
         ctx.closePath( );
         ctx.stroke();
         ctx.beginPath( );
         ctx.arc(0,0,15,0,Math.PI * 2,true);


         ctx.closePath( );
         ctx.strokeStyle= "yellow";

         ctx.stroke();
         ctx.restore();

         //Desenha Asteroide
         ctx.save();
         
         ctx.translate(asteroide.x, asteroide.y);
         ctx.beginPath( );
         ctx.arc(0,0,15,0,Math.PI * 2,true);


         ctx.closePath( );
         ctx.strokeStyle= "red";
         if (colisao) {
            ctx.fillStyle="red";
         } else {
            ctx.fillStyle="yellow";
         }
         
         ctx.fill();
         ctx.stroke();
         
         ctx.restore();

         



         jogador.angulo += jogador.vang * dt;
         jogador.x += jogador.vx;
         jogador.y -= jogador.vy;
         jogador.vx += jogador.aceleracao*Math.sin(jogador.angulo * 2 * Math.PI / 360)*dt;
         jogador.vy += jogador.aceleracao*Math.cos(jogador.angulo * 2 * Math.PI / 360)*dt;

         if(jogador.y<-20) {
            jogador.y = 500;
         }
         if(jogador.y>500) {
            jogador.y = -20;
         }
         if(jogador.x<-20) {
            jogador.x = 660;
         }
         if(jogador.x>660) {
            jogador.x = -20;
         }
         
         // Movimento do Asteroide
         asteroide.x += asteroide.vx*dt;
         asteroide.y += asteroide.vy*dt;

         if(asteroide.y<-20) {
            asteroide.y = 500;
         }
         if(asteroide.y>500) {
            asteroide.y = -20;
         }
         if(asteroide.x<-20) {
            asteroide.x = 660;
         }
         if(asteroide.x>660) {
            asteroide.x = -20;
         }

         d = Math.sqrt(Math.pow((asteroide.x-jogador.x),2) + Math.pow((asteroide.y-jogador.y),2));
         colisao = d < (15+15);
         



         tempo_anterior = tempo_atual;

      }
      window.setInterval(desenho, 1000/60);
   
      document.addEventListener("keydown", tecla_pressionada);
      document.addEventListener("keyup", tecla_solta)
      function tecla_pressionada(evento){
         console.log(evento.keyCode);
         if (evento.keyCode == 39){
            jogador.vang = 120;
         } else if(evento.keyCode == 37){
            jogador.vang = -120;
         }
         if(evento.keyCode == 38){
            jogador.aceleracao =  1;
         }  else if(evento.keyCode == 40){
            jogador.aceleracao = 0;
         }             
      }
      function tecla_solta(evento){
         if (evento.keyCode == 39){
            jogador.vang = 0;
         } else if(evento.keyCode == 37){
            jogador.vang = 0;
         }
         if(evento.keyCode == 38){
            jogador.aceleracao = 0;
         } else if(evento.keyCode == 40){
            jogador.aceleracao = 0;
         }
      }
         
         
   </script>
</body>

</html>






